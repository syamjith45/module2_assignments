show databases;
USE python29;
create table WORKER(
WORKER_ID int NOT NULL AUTO_INCREMENT,
FIRST_NAME varchar(36) NOT NULL,
LAST_NAME varchar(45) NOT NULL,
SALARY int NOT NULL,
JOINING_DATE datetime,
DEPARTMENT varchar(45) NOT NULL,
primary key(WORKER_ID)
);


INSERT INTO WORKER(FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT)
VALUES('Monika' ,'Arora', '100000', '2014-02-20 09:00:00', 'HR');
SELECT * FROM WORKER;
INSERT INTO WORKER(FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT)
VALUES('Niharika' ,'Verma', '80000', '2014-06-11 09:00:00', 'Admin'),
('Vishal', 'Singhal', '300000', '2014-02-20 09:00:00', 'HR'),
('Amitabh', 'Singh', '500000', '2014-02-20 09:00:00', 'Admin'),
('Vivek', 'Bhati', '500000', '2014-06-11 09:00:00', 'Admin'),
('Vipul', 'Diwan', '200000', '2014-06-11 09:00:00', 'Account'),
('Satish', 'Kumar', '75000','2014-01-20 09:00:00', 'Account'),
('Geetika', 'Chauhan', '90000', '2014-04-11 09:00:00', 'Admin');

UPDATE WORKER SET SALARY = 80000 WHERE WORKER_ID=1;




CREATE TABLE BONUS (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    WORKER_REF_ID INT,
    BONUS_DATE DATETIME,
    BONUS_AMOUNT DECIMAL(10, 2),
    UNIQUE (WORKER_REF_ID)
);

INSERT INTO BONUS (WORKER_REF_ID, BONUS_DATE, BONUS_AMOUNT)
VALUES
(1, '2016-02-20 00:00:00', 5000),
(2, '2016-06-11 00:00:00', 3000),
(3, '2016-02-20 00:00:00', 4000),
(1, '2016-02-20 00:00:00', 4500),
(2, '2016-06-11 00:00:00', 3500);

CREATE TABLE BONUS(
WORKERS_REF_ID int,
BONUS_DATE datetime,
BONUS_AMOUNT INT,
foreign key(WORKERS_REF_ID) REFERENCES WORKER(WORKER_ID)
);

insert into BONUS(WORKERS_REF_ID,BONUS_DATE,BONUS_AMOUNT)
VALUES(1, '2016-02-20 00:00:00', 5000),
    (2, '2016-06-11 00:00:00', 3000),
    (3, '2016-02-20 00:00:00', 4000),
    (1, '2016-02-20 00:00:00', 4500),
    (2, '2016-06-11 00:00:00', 3500);
SELECT * FROM BONUS
SELECT FIRST_NAME AS `<WORKER_NAME>` FROM WORKER;
SELECT UPPER(FIRST_NAME) AS UPPER_CASE_FIRST_NAME FROM WORKER;

SELECT DISTINCT DEPARTMENT FROM WORKER;

SELECT SUBSTRING(FIRST_NAME,1,3) AS FIRST_THREE_CHARACTERS FROM WORKER;
SELECT RTRIM(FIRST_NAME) AS TRIMMED_FIRST_NAME FROM WORKER;
SELECT REPLACE(FIRST_NAME,'a','A') AS MODIFIED_FIRST_NAME FROM WORKER;

SELECT CONCAT (FIRST_NAME ,' ', LAST_NAME) AS COMPLETE_NAME FROM WORKER;
SELECT * FROM WORKER ORDER BY FIRST_NAME ASC;
SELECT * FROM WORKER WHERE FIRST_NAME IN ('GEETIKA'
,'SATISH');
SELECT * FROM WORKER WHERE FIRST_NAME NOT IN ('VIPUL','SATISH');  
SELECT * FROM WORKER WHERE DEPARTMENT='ADMIN';
SELECT * FROM WORKER WHERE FIRST_NAME LIKE '%A%';

SELECT * FROM WORKER WHERE FIRST_NAME LIKE '%A';
SELECT * FROM WORKER WHERE SALARY BETWEEN 100000 AND 500000;
SELECT * FROM WORKER WHERE MONTH(JOINING_DATE)=2 AND YEAR(JOINING_DATE)=2014;


CREATE TABLE CUSTOMER(
CUSTOMER_ID INT PRIMARY KEY,
CUST_NAME CHAR(35),
CITY VARCHAR(35),
GRADE INT,
SALESMAN_ID INT
);

CREATE TABLE WORKER(
WORKER_ID INT PRIMARY KEY,
FIRST_NAME char(25),
LAST_NAME  CHAR(35),
SALARY INT,
JOINING_DATE datetime,
DEPARTMENT char(35)

);


CREATE TABLE BONUS(
WORKERS_REF_ID int,
BONUS_DATE datetime,
BONUS_AMOUNT INT,
foreign key(WORKERS_REF_ID) REFERENCES WORKER(WORKER_ID)
);



INSERT INTO WORKER (WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT) VALUES
     (1, 'Monika', 'Arora', 100000, '2014-02-20','HR'),
    (2, 'Niharika', 'Verma', 80000, '2014-06-11','ADMIN'),
    (3, 'Vishal', 'Singhal', 300000, '2014-02-20','HR'),
    (4, 'Amitabh', 'Singh', 500000, '2014-02-20','ADMIN'),
    (5, 'Vivek', 'Bhati', 500000, '2014-06-11','ADMIN'),
    (6, 'Vipul', 'Diwan', 200000, '2014-06-11','ACCOUNT'),
    (7, 'Satish', 'Kumar', 75000, '2014-01-20','ACCOUNT'),
    (8, 'Geetika', 'Chauhan', 90000, '2014-04-11','ADMIN');
    
INSERT INTO BONUS(WORKERS_REF_ID,BONUS_DATE,BONUS_AMOUNT) VALUES

    (1, '2016-02-20 00:00:00', 5000),
    (2, '2016-06-11 00:00:00', 3000),
    (3, '2016-02-20 00:00:00', 4000),
    (1, '2016-02-20 00:00:00', 4500),
    (2, '2016-06-11 00:00:00', 3500);
    
SELECT FIRST_NAME AS `<WORKER_NAME>` FROM WORKER;

SELECT UPPER(FIRST_NAME) AS UPPER_CASE_FIRST_NAME FROM WORKER;

SELECT DISTINCT DEPARTMENT FROM WORKER;

SELECT SUBSTRING(FIRST_NAME,1,3) AS FIRST_THREE_CHARACTERS FROM WORKER;

SELECT RTRIM(FIRST_NAME) AS TRIMMED_FIRST_NAME FROM WORKER;

SELECT REPLACE(FIRST_NAME,'a','A') AS MODIFIED_FIRST_NAME FROM WORKER;

SELECT CONCAT (FIRST_NAME ,' ', LAST_NAME) AS COMPLETE_NAME FROM WORKER;

SELECT * FROM WORKER ORDER BY FIRST_NAME ASC;

SELECT * FROM WORKER WHERE FIRST_NAME IN ('ABIN','SATISH');

SELECT * FROM WORKER WHERE FIRST_NAME NOT IN ('VIPUL','SATISH');  

SELECT * FROM WORKER WHERE DEPARTMENT='ADMIN';

SELECT * FROM WORKER WHERE FIRST_NAME LIKE '%A%';

SELECT * FROM WORKER WHERE FIRST_NAME LIKE '%A';

SELECT * FROM WORKER WHERE SALARY BETWEEN 100000 AND 500000;

SELECT * FROM WORKER WHERE MONTH(JOINING_DATE)=2 AND YEAR(JOINING_DATE)=2014;

CREATE TABLE CUSTOMER(
CUSTOMER_ID INT PRIMARY KEY,
CUST_NAME CHAR(35),
CITY VARCHAR(35),
GRADE INT,
SALESMAN_ID INT
);


CREATE TABLE SALESMAN(
SALESMAN_ID INT auto_increment PRIMARY KEY,
NAME CHAR(35),
CITY VARCHAR(35),
GRADE INT,
COMMISSION DECIMAL(10,2)
);

CREATE TABLE ORDERS (
    ORD_NO INT,
    PURCH_AMT DECIMAL(10, 2),
    ORD_DATE DATE,
    CUSTOMER_ID INT,
    SALESMAN_ID INT,
    FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID),
    FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)
);
INSERT INTO CUSTOMER(CUSTOMER_ID,CUST_NAME,CITY,GRADE,SALESMAN_ID) VALUES
 (3002, 'Nick Rimando', 'New York', 100, 5001),
    (3005, 'Graham Zusi', 'California', 200, 5002),
    (3001, 'Brad Guzan', 'London', 5005, NULL), 
    (3004, 'Fabian Johns', 'Paris', 300, 5006),
    (3007, 'Brad Davis', 'New York', 200, 5001),
    (3009, 'Geoff Camero', 'Berlin', 100, 5003),
    (3008, 'Julian Green', 'London', 300, 5002),
    (3003, 'Jozy Altidor', 'Moscow', 200, 5007);
    


INSERT INTO ORDERS (ORD_NO, PURCH_AMT, ORD_DATE, CUSTOMER_ID, SALESMAN_ID)
VALUES
    (70001, 150.5, '2012-10-05', 3005, 5002),
    (70009, 270.65, '2012-09-10', 3001, 5005),
    (70002, 65.26, '2012-10-05', 3002, 5001),
    (70004, 110.5, '2012-08-17', 3009, 5003),
    (70007, 948.5, '2012-09-10', 3005, 5002),
    (70005, 2400.6, '2012-07-27', 3007, 5001),
    (70008, 5760, '2012-09-10', 3002, 5001),
    (70010, 1983.43, '2012-10-10', 3004, 5006),
    (70003, 2480.4, '2012-10-10', 3009, 5003),
    (70012, 250.45, '2012-06-27', 3008, 5002),
    (70011, 75.29, '2012-08-17', 3003, 5007),
    (70013, 3045.6, '2012-04-25', 3002, 5001);
select * FROM ORDERS
SELECT C.CUST_NAME AS CUSTOMER_NAME,S.NAME AS SALESMAN_NAME
FROM CUSTOMER C INNER JOIN SALESMAN S ON C.SALESMAN_ID=S.SALESMAN_ID;

SELECT C.CUST_NAME AS CUSTOMER_NAME,C.CITY AS CUSTOMER_CITY,S.name AS Salesman_Name, 
S.city AS Salesman_City FROM CUSTOMER C
INNER JOIN SALESMAN S ON C.city = S.city;

SELECT O.ord_no, O.ord_date, C.cust_name AS Customer_Name, C.city AS Customer_City, 
S.name AS Salesman_Name, S.city AS Salesman_City
FROM ORDERS O
INNER JOIN CUSTOMER C ON O.customer_id = C.customer_id
INNER JOIN SALESMAN S ON O.salesman_id = S.salesman_id
WHERE C.city <> S.city;

SELECT O.ord_no, C.cust_name AS Customer_Name
FROM ORDERS O
INNER JOIN CUSTOMER C ON O.customer_id = C.customer_id;

SELECT C.cust_name AS Customer_Name, C.grade AS Customer_Grade
FROM CUSTOMER C
INNER JOIN ORDERS O ON C.customer_id = O.customer_id
INNER JOIN SALESMAN S ON O.salesman_id = S.salesman_id
WHERE C.grade IS NOT NULL AND S.city IS NOT NULL
ORDER BY C.cust_name;